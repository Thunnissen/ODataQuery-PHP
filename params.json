{"name":"Odataquery-php","tagline":"A library of PHP Classes that allow for OData queries to be easily built and extended for appending to a URL Request to an API supporting OData server-side.","body":"ODataQuery-PHP\r\n==============\r\n\r\nA library of PHP Classes that allow for OData queries to be easily built and extended for appending to a URL Request to a server-side API supporting OData.\r\n\r\n<h2>Installation</h2>\r\n\r\n<h3>Included in a PHP Project w/ Composer</h3>\r\n\r\nAdd the following to your composer.json file:\r\n\r\n```JSON\r\n\"require\": {\r\n    \"curiosity26/odataquery\": \"dev-master\"\r\n}\r\n```\r\n\r\n<h3>Standalone Project</h3>\r\nODataQuery-PHP is packaged for Composer. If you don't have composer installed, go to https://getcomposer.org/ download and install.\r\n\r\nOnce composer is installed, use your command line terminal and cd into the ODataQuery-PHP folder. Run 'composer install'. If you have composer installed correctly, it should work fine and you'll see a new directory created called 'vendors'. Within the vendors folder there is an autoload.php file created by composer.\r\n\r\n<h2>Basic Usage</h2>\r\n\r\nInclude this autoloader when loading your own code module or on any scripts that you are using ODataQuery-PHP in.\r\n```PHP\r\n$autoloader = \"/path/to/ODataQuery-PHP/vendor/autoload.php\";\r\nrequire_once $autoloader;\r\n```\r\n\r\n<h2>Example</h2>\r\n\r\nOur base API URL:\r\n```PHP\r\n$apiUrl = \"http://www.example.com/test/api/\";\r\n```\r\nFirst we'll build a path for the request of objects.\r\n(Namespaces will be implied in examples. Assuming you're using and IDE and the autoloader created by composer, these will be filled out for you anyway)\r\n```PHP\r\n$property = 'Employees';\r\n$path = new ODataResourcePath($apiUrl.$property);\r\n```\r\nThe created path can be used just like a string variable:\r\n```PHP\r\nprint $path;\r\n// http://www.example.com/test/api/Employees\r\n```\r\nIf you to force the path to be used as a string (sometimes helpful when passing as a variable into a function that requires a string parameter) you can simply cast the ODataResourcePath object as a string. The goes for any object in the ODataQuery library.\r\n```PHP\r\nmyFakeFunction((string)$path);\r\n```\r\n<h3>$select</h3>\r\n\r\nYou can select which properties of the returned objects are included:\r\n```PHP\r\n$path->select(new ODataQuerySelect(array(\"FirstName\", \"LastName\")));\r\n```\r\nSee the Expand section below to learn how select can be applied to specific properties.\r\n\r\n<h3>$search</h3>\r\n\r\nYou can search the properties of the object set using search:\r\n```PHP\r\n$path->search(new ODataQuerySearch('mountain bike'));\r\n```\r\nSearch queries are also chainable:\r\n```PHP\r\n$search = $path->search(); \r\n// operations functions are both setters and getters. When setting, the funciton returns the $path object for chainability\r\n$search->_and('balloon');\r\n$path->search($search);\r\n```\r\nThis will now search the set of Employees objects to be returned for '\"mountain bike\" AND balloon'. See the Expand section below to learn how the search function can be applied to specific properties.\r\n\r\n<h3>$count</h3>\r\n\r\nYou can return the total record count of your query. The $count system query option ignores any $top, $skip, or $expand query options, and returns the total count of results across all pages including only those results matching any specified $filter and $search. Clients should be aware that the count returned inline may not exactly equal the actual number of items returned, due to latency between calculating the count and enumerating the last value or due to inexact calculations on the service.\r\n```PHP\r\n$path->count();\r\n$path->count(FALSE); // Disables $count\r\n```\r\n<h3>$filter</h3>\r\n\r\nThe recordset queried can be filtered to return a more precise set of records. There are various filters available and most can be used in combination with another. \r\n```PHP\r\n$filter = new ODataGreaterThanEqualsFilter('YearsEmployed', 6); // YearsEmployed ge 6\r\n$path->filter($filter);\r\n```\r\nEach filter has a set of extensible functions that allow the filter to be passed into another filter, returning the new filter.\r\n```PHP\r\n$add_filter = new ODataAddFilter('YearsEmployed', 5); // YearsEmployed add 5\r\n$filter = $add_filter->greaterThanEquals(6); // YearsEmployed add 5 ge 6\r\n$path->filter($filter);\r\n```\r\nFilters can accept Filters as properties or values and a value can also be a property name\r\n```PHP\r\n$sub_filter = new ODataSubtractFilter('YearsEmployed', 'YearsSebatical'); // YearsEmployed sub YearsSebatical\r\n$sub_filter2 = new ODataAddFilter('Awards', 'Demotions'); // Awards sub Demotions\r\n$filter = $sub_filter->greaterThan($sub_filter2); // (YearsEmployed sub YearsSebatical) gt (Awards sub Demotions)\r\n$path->filter($filter);\r\n```\r\n<h3>$pager</h3>\r\n\r\nRecords can be paged server-side by passing $top and $skip where $top is the limit of records returned and $skip is the start offset. The ODataQueryPager object takes the math out of the equation and lets you simply specify the limit and the page you want to return.\r\n```PHP\r\n$pager = new ODataQueryPager(20, 5); // $top=20&$skip=100\r\n$path->pager($pager);\r\n```\r\n\r\n<h3>$orderby</h3>\r\n\r\nResults can be sorted by a property name within the collection. Simply specify which property you would like to sort by in the orderBy() function.\r\n\r\n```PHP\r\n$path->orderBy('LastName');\r\n```\r\n\r\n<h3>$expand</h3>\r\n\r\nThe ODataQueryExpand object is used to subquery the results of the main query. It can be applied to properties of the main query's recordset using OData's path format (Property1/SubProperty1/AndSoOn) or to an expanded upon property (deep injection).\r\n\r\nThe ODataQueryExpand object is built off the same parent class as ODataResourcePath; ODataResource. So all of the above functions are available on the ODataQueryExpand object, including expand, which allows an expanded upon property to expand upon itself (deep injection).\r\n\r\nBecause multiple properties can be expanded upon, the expand() function of ODataResourcePath and ODataQueryExpand require a collection of ODataExpandableInterface objects in the form of a single ODataQueryExpandCollection object. The ODataQueryExpand objects must be added to the ODataQueryExpandCollection which is then passed to the ODataResourcePath or ODataQueryExpand objects.\r\n```PHP\r\n$collection = new ODataQueryExpandCollection();\r\n\r\n$expand1 = new ODataQueryExpand('FirstName'); // Expand upon the FirstName property\r\n$filter = new ODataEqualsFilter('$it', \"'Alex'\"); // Only string filter functions safely wrap strings. Other filters can't distinguish between a regular string function or a property name\r\n$expand1->filter($filter);\r\n$collection->add($expand1);\r\n\r\n$expand2 = new ODataQueryExpand('LastName'); // Expand upon the LastName property\r\n$search = new ODataQuerySearch(\"Boyce\");\r\n$expand2->search($search); // Search the last name\r\n$collection->add($expand2);\r\n\r\n$expand3 = new ODataQueryExpand('Address');\r\n$expand4 = new ODataQueryExpand('City'); // Assuming the Address is an object containing City and not a sibling of City\r\n$search2 = new ODataQuerySearch('New York');\r\n$expand4->search($search2);\r\n$expand3->expand(new ODataQueryExpandCollection(array($expand4))); // Add $expand4 to $expand3, wrapping it in a collection\r\n$collection->add($expand3);\r\n\r\n$path->expand($collection);\r\n\r\n// OUTPUT PATH: http://www.example.com/test/api/Employees?$expand=FirstName($filter=$it eq 'Alex'),LastName($search=Boyce),Address($expand=City($search=\"New York\"))&$order=ASC\r\n```\r\n\r\n<h2>Resource Path Only<h2>\r\n<h3>Parameters</h3>\r\n\r\nParameters can be used in place of any property of value in any query object. Prefix the variable name with '@' when using the variable. Use the ODataQueryParameterCollection object and set your parameters as if you were setting public variables on the object.\r\n\r\n```PHP\r\n$params = new ODataQueryParameterCollection();\r\n$params->myParam1 = 10;\r\n$params->otherParam = \"Other\";\r\n\r\n$filter = new ODataLessThanEquals('@otherPraram', '@myParam1');\r\n\r\n$path->filter($filter)->parameters($params);\r\n\r\n// OUTPUT PATH: http://www.example.com/test/api/Employees?$filter=@otherParam le @myParam1&$order=ASC&@myParam1=10&@otherParam=Other\r\n```\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}